generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model AuditTrail {
  id          String   @id @default(cuid())
  timestamp   DateTime @default(now())
  action      String
  userId      String
  userName    String
  userRole    String?
  caseId      String
  caseType    String
  field       String?
  oldValue    String?
  newValue    String?
  description String?
  metadata    String?

  @@index([caseId, caseType])
  @@index([timestamp])
  @@index([action])
  @@index([userId])
}

model Notification {
  id        String   @id @default(cuid())
  userId    String
  reference Json
  payload   Json
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([userId, isRead])
  @@index([createdAt])
  @@map("notifications")
}

model NotificationType {
  id          String   @id @default(cuid())
  code        String   @unique
  name        String
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  @@map("notification_types")
}

model ServiceCode {
  id          String   @id @default(cuid())
  code        String   @unique
  name        String
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  @@map("service_codes")
}

model DraftSubmission {
  id        String   @id @default(cuid())
  userId    String   @unique
  formData  Json
  formType  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("draft_submissions")
}

model Comment {
  id        String   @id @default(cuid())
  content   String
  createdAt DateTime @default(now())
  userId    String
  userName  String
  userRole  String?
  caseId    String
  caseType  String

  @@index([caseId, caseType])
}

model Draft {
  id        String   @id @default(cuid())
  content   String
  formType  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  userId    String
  userName  String
  userRole  String?
  caseId    String?
  caseType  String?

  @@unique([userId, formType, caseId])
  @@index([userId, formType])
  @@index([caseId, caseType])
}
